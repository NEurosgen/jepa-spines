# JEPA-SpineGraphs: Joint-Embedding Predictive Architecture for Dendritic Spine Graphs

## üß† Overview

This project implements a **Joint-Embedding Predictive Architecture (JEPA)** for **graph-based representations of dendritic spines** extracted from 3D neuron reconstructions.  
The model learns to encode **morphological and contextual structure** of neuronal spines using **graph neural networks** (GNNs) and **NEURD feature extractors**.

Each neuron is represented as a **graph**, where:
- **Nodes** correspond to dendritic spines or branch segments.
- **Edges** capture spatial or topological adjacency.
- **Node features** are computed automatically via `neurd.feature_extractor`.

The goal is to learn **self-supervised embeddings** capable of distinguishing **healthy vs pathological** morphology and capturing local graph context for downstream tasks (e.g., classification, clustering, morphology analysis).

---

## ‚öôÔ∏è Architecture

### Joint-Embedding Predictive Architecture (JEPA)

The core idea is to predict **target graph patches** (latent embeddings) from **context patches**, without explicit reconstruction.

Main components:
- **Encoder**: GNN (GIN / GraphSAGE / GAT) that maps each node to a latent vector `z`.
- **Predictor**: MLP that aligns the encoded context and target embeddings via a contrastive-style loss.
- **Target encoder**: momentum-updated copy of the main encoder (EMA teacher).

Training objective minimizes the **distance between latent representations** of the same region under perturbations:
\[
L = \| f_{\theta}(x_{context}) - f_{\xi}(x_{target}) \|_2^2
\]
where \(\xi\) is updated with EMA of \(\theta\).

---

## üß© Data

Input data are **graph pickles (`.gpickle`)** generated by NEURD.

Each graph corresponds to a dendritic branch and contains:
- `G.nodes[i]['mesh']`: mesh object of a spine or dendritic fragment  
- `G.nodes[i]['features']`: NEURD-extracted geometric descriptors  
- Optional topological metadata: `branch_index`, `spine_index`, `type`, etc.

### Dataset structure

